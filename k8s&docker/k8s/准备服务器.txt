
1.基于vmware安装3台ubuntu 22.04
稍后安装操作系统
自定义硬件-桥接模式（不复制物理网络连接状态）
CD/DVD选择ISO
最小安装

2.安装常用软件
apt-get update
apt-get install -y openssh-server vim net-tools curl
【创建快照init】

3.配置静态IP
方式1.界面操作
设置-网络-有线-记录信息，比如
IPv4地址：172.24.223.124
默认路由：172.24.208.1
DNS：172.24.208.1

然后移除连接配置，有线+，IPv4 手动
地址：172.24.223.101
子网掩码：255.255.255.0
网关：172.24.208.1
DNS：172.24.208.1
最后添加

master：172.24.223.101
node1：172.24.223.102
node2：172.24.223.103

方式2.命令行
cd /etc/netplan
cp 01-network-manager-all.yaml 01-network-manager-all.yaml.bak
vi 01-network-manager-all.yaml
修改如下
network:
  version: 2
  renderer: NetworkManager
  ethernets:
    ens33:
      dhcp4: no
      addresses: [自定义ip/24]
      nameservers:
        addresses: [8.8.8.8, 8.8.4.4]
      routes:
        - to: 0.0.0.0/0
          via: 192.168.10.1

netplan apply

master  ip设置为192.168.10.50
node1   ip设置为192.168.10.102
node2   ip设置为192.168.10.103

【创建快照ip init】

3.apt源配置
mv /etc/apt/sources.list /etc/apt/sources.list.bak
vi /etc/apt/sources.list

#添加阿里源
deb https://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse

deb https://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse

deb https://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse

# deb https://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse
# deb-src https://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse

deb https://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse

apt-get update

添加k8s的apt仓库
apt install -y ca-certificates apt-transport-https
echo "deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main" > /etc/apt/sources.list.d/kubernetes.list
curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add
cp /etc/apt/trusted.gpg /etc/apt/trusted.gpg.d/
apt-get update

【创建快照apt init】

4.其他配置
# 关闭 Swap（K8s 要求）
swapoff -a
# 永久关闭（注释 swap 行）
sed -i '/swap/s/^/#/' /etc/fstab
设置-电源-息屏-改为从不

【创建快照all init】
