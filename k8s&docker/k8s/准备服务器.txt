
基于vmware安装3台ubuntu

# 安装ssh
apt update && apt install -y openssh-server vim

配置静态IP
cd /etc/netplan
cp 01-network-manager-all.yaml 01-network-manager-all.yaml.bak
vi 01-network-manager-all.yaml
修改如下
network:
  version: 2
  renderer: networkd
  ethernets:
    ens33:
      dhcp4: no
      addresses: [自定义ip/24]
      nameservers:
        addresses: [8.8.8.8, 8.8.4.4]
      routes:
        - to: 0.0.0.0/0
          via: 192.168.10.1

netplan apply

master  ip设置为192.168.10.50
node1   ip设置为192.168.10.102
node2   ip设置为192.168.10.103

验证网络
在master中执行
ping 192.168.10.102
ping 192.168.10.103

# 关闭 Swap（K8s 要求）
swapoff -a
# 永久关闭（注释 swap 行）
sed -i '/swap/s/^/#/' /etc/fstab

apt配置源
cp /etc/apt/sources.list /etc/apt/sources.list.bak

#添加阿里源
deb https://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse

deb https://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse

deb https://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse

# deb https://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse
# deb-src https://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse

deb https://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse

apt-get update

添加k8s的apt仓库
apt install -y ca-certificates apt-transport-https curl
echo "deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main" > /etc/apt/sources.list.d/kubernetes.list
curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add
apt-get update

如果出现 密钥存储在过时的 trusted.gpg 密钥环中（/etc/apt/trusted.gpg），请参见 apt-key(8) 的 DEPRECATION 一节以了解详情。
则执行cd /etc/apt
sudo cp trusted.gpg trusted.gpg.d/
